<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reproducing Parts of Neuenschwander et al. (2016) • bhmbasket</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reproducing Parts of Neuenschwander et al. (2016)">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bhmbasket</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.5.999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/reproduceExNex.html">Reproducing Parts of Neuenschwander et al. (2016)</a>
    </li>
    <li>
      <a href="../articles/Running_bhmbasket_on_HPC.html">Running bhmbasket on HPC</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reproducing Parts of Neuenschwander et
al. (2016)</h1>
                        <h4 data-toc-skip class="author">Stephan
Wojciekowski</h4>
            
            <h4 data-toc-skip class="date">January 23, 2026</h4>
      

      <div class="hidden name"><code>reproduceExNex.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates how to use the R package
<code>bhmbasket</code> to reproduce parts of “Robust exchangeability
designs for early phase clinical trials with multiple strata” by <span class="citation">Neuenschwander et al. (2016)</span>.</p>
<p>Two examples are shown in this vignette: the analysis of a basket
trial’s outcome with the ExNex approach, and the assessment of the
operating characteristics of a planned basket trial under several
scenarios.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=bhmbasket" class="external-link">bhmbasket</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">rng_seed</span> <span class="op">&lt;-</span> <span class="fl">123</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">rng_seed</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="analysis-of-a-basket-trials-outcome">Analysis of a Basket Trial’s Outcome<a class="anchor" aria-label="anchor" href="#analysis-of-a-basket-trials-outcome"></a>
</h2>
<p>Section 2 of <span class="citation">Neuenschwander et al.
(2016)</span> discusses the application of the ExNex approach to the
results of the phase II sarcoma basket trial by <span class="citation">Chugh et al. (2009)</span>. The prior specifications
and the estimated response rates per cohort are shown in the Appendix of
<span class="citation">Neuenschwander et al. (2016)</span>.</p>
<div class="section level3">
<h3 id="creating-the-trial">Creating the trial<a class="anchor" aria-label="anchor" href="#creating-the-trial"></a>
</h3>
<p>A single trial with a given outcome can be created with the function
<code><a href="../reference/createTrial.html">createTrial()</a></code>, which takes as arguments the number of
subjects and the number of responders of the trial. The outcome of the
basket trial by <span class="citation">Chugh et al. (2009)</span> can be
set up as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chugh_trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTrial.html">createTrial</a></span><span class="op">(</span></span>
<span>  n_subjects   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">13</span>, <span class="fl">12</span>, <span class="fl">28</span>, <span class="fl">29</span>, <span class="fl">29</span>, <span class="fl">26</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  n_responders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-the-model">Running the model<a class="anchor" aria-label="anchor" href="#running-the-model"></a>
</h3>
<p>The analysis of the trial is handled by the function
<code><a href="../reference/performAnalyses.html">performAnalyses()</a></code>, to which to the
<code>chugh_trial</code>, the name of the method <code>"exnex"</code>,
and the prior parameters as shown in Appendix 5.3 of <span class="citation">Neuenschwander et al. (2016)</span> are provided:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chugh_prior_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setPriorParametersExNex.html">setPriorParametersExNex</a></span><span class="op">(</span></span>
<span>  mu_mean   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.735</span>, <span class="fl">0.847</span><span class="op">)</span>,</span>
<span>  mu_sd     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.146</span>, <span class="fl">0.266</span><span class="op">)</span><span class="op">^</span><span class="op">-</span><span class="fl">0.5</span>,</span>
<span>  tau_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu_j      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.734</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  tau_j     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.128</span><span class="op">^</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  w_j       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"chugh_analysis.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">chugh_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"chugh_analysis.rds"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">chugh_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performAnalyses.html">performAnalyses</a></span><span class="op">(</span></span>
<span>  scenario_list         <span class="op">=</span> <span class="va">chugh_trial</span>,</span>
<span>  method_names          <span class="op">=</span> <span class="st">"exnex"</span>,</span>
<span>  prior_parameters_list <span class="op">=</span> <span class="va">chugh_prior_parameters</span>,</span>
<span>  seed                  <span class="op">=</span> <span class="va">rng_seed</span>,</span>
<span>  n_mcmc_iterations     <span class="op">=</span> <span class="fl">5e4</span>,</span>
<span>  n_cores               <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  verbose               <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">chugh_analysis</span>, <span class="st">"chugh_analysis.rds"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="getting-the-estimates">Getting the estimates<a class="anchor" aria-label="anchor" href="#getting-the-estimates"></a>
</h3>
<p>One can use the function <code><a href="../reference/getEstimates.html">getEstimates()</a></code> to get point
estimates and credible intervals of the response rates:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getEstimates.html">getEstimates</a></span><span class="op">(</span>analyses_list <span class="op">=</span> <span class="va">chugh_analysis</span><span class="op">)</span></span>
<span><span class="co">#&gt; $exnex</span></span>
<span><span class="co">#&gt; $exnex$scenario_1</span></span>
<span><span class="co">#&gt;            Mean         SD         2.5%        50%     97.5%</span></span>
<span><span class="co">#&gt; p_1  0.15077467 0.06293024 0.0392848259 0.14745358 0.2915622</span></span>
<span><span class="co">#&gt; p_2  0.05287414 0.05895604 0.0002959401 0.02684776 0.1941751</span></span>
<span><span class="co">#&gt; p_3  0.12699904 0.06781268 0.0123062080 0.12706481 0.2672502</span></span>
<span><span class="co">#&gt; p_4  0.18849350 0.06009882 0.0930300121 0.18020901 0.3305355</span></span>
<span><span class="co">#&gt; p_5  0.20512931 0.06550208 0.1060958755 0.19408070 0.3631065</span></span>
<span><span class="co">#&gt; p_6  0.13140558 0.05094556 0.0383863302 0.13079420 0.2355352</span></span>
<span><span class="co">#&gt; p_7  0.17669509 0.05732098 0.0821657158 0.17034967 0.3101239</span></span>
<span><span class="co">#&gt; p_8  0.17857554 0.10398925 0.0271685311 0.16135326 0.4669779</span></span>
<span><span class="co">#&gt; p_9  0.13019866 0.11375943 0.0010129288 0.12100970 0.4291611</span></span>
<span><span class="co">#&gt; p_10 0.15732452 0.05807734 0.0552504578 0.15348422 0.2879676</span></span></code></pre></div>
<p>By comparing these values to the respective numbers provided by <span class="citation">Neuenschwander et al. (2016)</span> in Appendix 5.3 one
can see that the results are equal to the second decimal place.</p>
</div>
</div>
<div class="section level2">
<h2 id="trialOC">Assessing the Operating Characteristics of a Basket Trial
Design<a class="anchor" aria-label="anchor" href="#trialOC"></a>
</h2>
<p>Section 3.1 of <span class="citation">Neuenschwander et al.
(2016)</span> presents the design and the operating characteristics of a
phase II basket trial in four indications. In their publication, the
authors present the scenarios with the respective true response rates
per cohort in Table V along with the respective cohort-wise go
probabilities, biases, and mean squared errors. The number of subjects
is 20 each for the first two cohorts and 10 each for the last two
cohorts.</p>
<!-- As a side note: the number of simulated trials used by @exnex2016 is unclear. -->
<!-- The first two cohorts should yield the same operating characteristics when their true response rates are equal, and this should also hold true for the last two cohorts. -->
<!-- However, the numbers reported by @exnex2016 do not always meet this expectation (see e.g. the reported biases of Scenario 3). -->
<div class="section level3">
<h3 id="simulating-the-scenarios">Simulating the scenarios<a class="anchor" aria-label="anchor" href="#simulating-the-scenarios"></a>
</h3>
<p>The scenarios are simulated with the function
<code><a href="../reference/simulateScenarios.html">simulateScenarios()</a></code>. There are seven different scenarios
presented in Table V. In this example, the Scenarios 1, 3, and 4 are
reproduced. For each scenario, 10000 basket trial realizations are
simulated:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scenarios_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateScenarios.html">simulateScenarios</a></span><span class="op">(</span></span>
<span>  n_subjects_list     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  response_rates_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  scenario_numbers    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  n_trials            <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="performAnalysis">Running the model<a class="anchor" aria-label="anchor" href="#performAnalysis"></a>
</h3>
<p>The analysis of each simulated basket trial is performed with the
function <code><a href="../reference/performAnalyses.html">performAnalyses()</a></code>. <span class="citation">Neuenschwander et al. (2016)</span> use the posterior
means of the cohorts’ response rates to calculate the biases and mean
squared errors, as well as to derive cohort-wise decisions. Setting the
argument <code>post_mean</code> to <code>TRUE</code> will save the
posterior means along with the posterior probability thresholds, which
are required for the decision making laid out below. The prior
parameters for the ExNex model are taken from Section 3.1 and Appendix
5.1.2 of <span class="citation">Neuenschwander et al. (2016)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setPriorParametersExNex.html">setPriorParametersExNex</a></span><span class="op">(</span></span>
<span>  mu_mean   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/logit.html">logit</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, <span class="fu"><a href="../reference/logit.html">logit</a></span><span class="op">(</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  mu_sd     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.18</span>, <span class="fl">1.94</span><span class="op">)</span>,</span>
<span>  tau_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu_j      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="../reference/logit.html">logit</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  tau_j     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  w_j       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"analyses_list.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">analyses_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"analyses_list.rds"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">analyses_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performAnalyses.html">performAnalyses</a></span><span class="op">(</span></span>
<span>    scenario_list         <span class="op">=</span> <span class="va">scenarios_list</span>,</span>
<span>    method_names          <span class="op">=</span> <span class="st">"exnex"</span>,</span>
<span>    prior_parameters_list <span class="op">=</span> <span class="va">prior_parameters</span>,</span>
<span>    seed                  <span class="op">=</span> <span class="va">rng_seed</span>,</span>
<span>    n_mcmc_iterations     <span class="op">=</span> <span class="fl">5e4</span>,</span>
<span>    n_cores               <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">analyses_list</span>, <span class="st">"analyses_list.rds"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note that although the total number of simulated trials is 3 x 10000,
there are only 2314 unique trial realizations among the three scenarios.
As the function <code><a href="../reference/performAnalyses.html">performAnalyses()</a></code> takes advantage of this,
its run time is reduced when compared to applying the model to all
simulated trials. However, some additional time is required to map the
results from the unique trials back to the simulated trials of each
scenario.</p>
</div>
<div class="section level3">
<h3 id="estimating-the-biases-and-mses">Estimating the biases and MSEs<a class="anchor" aria-label="anchor" href="#estimating-the-biases-and-mses"></a>
</h3>
<p>The bias and mean squared error (MSE) per cohort, as well as some
posterior quantiles, are estimated with <code><a href="../reference/getEstimates.html">getEstimates()</a></code>. The
argument <code>point_estimator = "mean"</code> ensures that the mean
instead of the median will be used for calculating the biases and MSEs.
In order to better assess and compare the results with the numbers
presented by <span class="citation">Neuenschwander et al. (2016)</span>,
scaling and rounding may be applied with
<code><a href="../reference/scaleRoundList.html">scaleRoundList()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getEstimates.html">getEstimates</a></span><span class="op">(</span></span>
<span>    analyses_list   <span class="op">=</span> <span class="va">analyses_list</span>,</span>
<span>    point_estimator <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/scaleRoundList.html">scaleRoundList</a></span><span class="op">(</span></span>
<span>  list         <span class="op">=</span> <span class="va">estimates</span>,</span>
<span>  scale_param  <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  round_digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $exnex</span></span>
<span><span class="co">#&gt; $exnex$scenario_1</span></span>
<span><span class="co">#&gt;      Mean   SD 2.5%  50% 97.5% Bias  MSE</span></span>
<span><span class="co">#&gt; p_1 10.76 6.01 2.46 9.65 25.26 0.76 0.34</span></span>
<span><span class="co">#&gt; p_2 10.61 5.97 2.39 9.50 25.05 0.61 0.33</span></span>
<span><span class="co">#&gt; p_3 11.54 8.06 1.66 9.64 31.86 1.54 0.56</span></span>
<span><span class="co">#&gt; p_4 11.62 8.10 1.68 9.73 32.02 1.62 0.56</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exnex$scenario_3</span></span>
<span><span class="co">#&gt;      Mean    SD 2.5%   50% 97.5%  Bias  MSE</span></span>
<span><span class="co">#&gt; p_1 11.19  6.21 2.54 10.07 26.07  1.19 0.37</span></span>
<span><span class="co">#&gt; p_2 11.34  6.25 2.60 10.21 26.30  1.34 0.38</span></span>
<span><span class="co">#&gt; p_3 28.75 12.22 9.11 27.42 55.60 -1.25 1.65</span></span>
<span><span class="co">#&gt; p_4 28.82 12.23 9.14 27.50 55.70 -1.18 1.64</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exnex$scenario_4</span></span>
<span><span class="co">#&gt;      Mean    SD  2.5%   50% 97.5%  Bias  MSE</span></span>
<span><span class="co">#&gt; p_1 11.15  6.21  2.54 10.01 26.10  1.15 0.37</span></span>
<span><span class="co">#&gt; p_2 11.07  6.18  2.51  9.93 25.97  1.07 0.37</span></span>
<span><span class="co">#&gt; p_3 12.21  8.42  1.80 10.26 33.30  2.21 0.66</span></span>
<span><span class="co">#&gt; p_4 46.73 14.01 20.69 46.49 74.06 -3.27 2.32</span></span></code></pre></div>
<!-- Comparing the biases and MSEs with the respective numbers provided in Table V of @exnex2016, one can see that for the scaled MSEs the results are equal to the second decimal place. -->
<!-- However, some scaled biases differ in the first decimal place. -->
<!-- Please note that the first and last two cohorts should yield the same operating characteristics when their true response rates are equal, which is fulfilled by the results provided by `bhmbasket`. -->
<p>Comparing the biases and MSEs with the respective numbers provided in
Table V of <span class="citation">Neuenschwander et al. (2016)</span>,
one can see that the results are rather similar.</p>
</div>
<div class="section level3">
<h3 id="estimating-the-cohort-wise-go-probabilities">Estimating the cohort-wise go probabilities<a class="anchor" aria-label="anchor" href="#estimating-the-cohort-wise-go-probabilities"></a>
</h3>
<p>The cohort-wise go decisions are derived with the function
<code><a href="../reference/getGoDecisions.html">getGoDecisions()</a></code>, which applies the specified decision
rules to each simulated basket trial for each scenario. The estimated go
probabilities for each scenario can then be derived with the function
<code><a href="../reference/getGoProbabilities.html">getGoProbabilities()</a></code>.</p>
<p>The set up of the decision rules in <code><a href="../reference/getGoDecisions.html">getGoDecisions()</a></code>
warrants further explanation. Generally, a simple decision rule for a go
in a single cohort
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
can be written as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>j</mi></msub><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">data</mtext><mo>&gt;</mo><msub><mover><mi>p</mi><mo accent="true">‾</mo></mover><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><msub><mi>γ</mi><mi>j</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">P(p_j|\text{data} &gt; \bar{p}_{j}) &gt; \gamma_j,</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>j</mi></msub><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">data</mtext></mrow><annotation encoding="application/x-tex">p_j|\text{data}</annotation></semantics></math>
is the posterior response rate,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>p</mi><mo accent="true">‾</mo></mover><mi>j</mi></msub><annotation encoding="application/x-tex">\bar{p}_{j}</annotation></semantics></math>
is the is the boundary response rate, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\gamma_j</annotation></semantics></math>
is the posterior evidence level for a go decision. Thus, the decision
rule consists of three parts: the posterior response rate, the boundary
response rate, and the posterior probability threshold. The arguments
for setting up the decision rules correspond to these three parts:
<code>cohort_names</code> picks the posterior response rates,
<code>boundary_rules</code> specifies the boundary response rates and
type of comparison, and <code>evidence_levels</code> provides the
posterior evidence levels. For example, the decision rule
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">data</mtext><mo>&gt;</mo><mn>0.1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">P(p_1|\text{data} &gt; 0.1) &gt; 0.9</annotation></semantics></math>
would then be implemented as</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_names</span>    <span class="op">=</span> <span class="st">"p_1"</span></span>
<span><span class="va">boundary_rules</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">evidence_levels</span> <span class="op">=</span> <span class="fl">0.9</span></span></code></pre></div>
<p>It is possible to specify different boundary rules and evidence
levels for different analysis methods with <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>. In this
case, only the ExNex method is applied and no list is needed. Note that
only evidence levels specified in <code><a href="../reference/performAnalyses.html">performAnalyses()</a></code> can be
utilized.</p>
<p>It is possible to implement combined decision criteria, such as
utilized by <span class="citation">Neuenschwander et al. (2016)</span>
who require in Section 3.1 for a go decision in the first cohort that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">data</mtext><mo>&gt;</mo><mn>0.1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0.9</mn><mspace width="1.0em"></mspace><mo>∧</mo><mspace width="1.0em"></mspace><mtext mathvariant="normal">Mean</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">P(p_1|\text{data} &gt; 0.1) &gt; 0.9 \quad\land\quad \text{Mean}(p_1|\text{data}) &gt; 0.2</annotation></semantics></math>
holds true. This combined decision rule would then be implemented as</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_names</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_1"</span>, <span class="st">"p_1"</span><span class="op">)</span></span>
<span><span class="va">boundary_rules</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.1</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">evidence_levels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<p>Thus, the go probabilities for the Scenarios 1, 3, and 4 can be
estimated by:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decisions_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGoDecisions.html">getGoDecisions</a></span><span class="op">(</span></span>
<span>  analyses_list   <span class="op">=</span> <span class="va">analyses_list</span>,</span>
<span>  cohort_names    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_1"</span>, <span class="st">"p_1"</span>,</span>
<span>                      <span class="st">"p_2"</span>, <span class="st">"p_2"</span>,</span>
<span>                      <span class="st">"p_3"</span>, <span class="st">"p_3"</span>,</span>
<span>                      <span class="st">"p_4"</span>, <span class="st">"p_4"</span><span class="op">)</span>,</span>
<span>  evidence_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="st">"mean"</span>,</span>
<span>                      <span class="fl">0.9</span>, <span class="st">"mean"</span>,</span>
<span>                      <span class="fl">0.8</span>, <span class="st">"mean"</span>,</span>
<span>                      <span class="fl">0.8</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>  boundary_rules  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.1</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.2</span>,</span>
<span>                            <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.1</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.2</span>,</span>
<span>                            <span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.1</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.2</span>,</span>
<span>                            <span class="va">x</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.1</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">go_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGoProbabilities.html">getGoProbabilities</a></span><span class="op">(</span><span class="va">decisions_list</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/scaleRoundList.html">scaleRoundList</a></span><span class="op">(</span></span>
<span>  list         <span class="op">=</span> <span class="va">go_probabilities</span>,</span>
<span>  scale_param  <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  round_digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; $exnex</span></span>
<span><span class="co">#&gt; $exnex$scenario_1</span></span>
<span><span class="co">#&gt;    overall decision_1 decision_2 decision_3 decision_4</span></span>
<span><span class="co">#&gt; Go       8          0          0          3          6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exnex$scenario_3</span></span>
<span><span class="co">#&gt;    overall decision_1 decision_2 decision_3 decision_4</span></span>
<span><span class="co">#&gt; Go      68          0         13          6         67</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exnex$scenario_4</span></span>
<span><span class="co">#&gt;    overall decision_1 decision_2 decision_3 decision_4</span></span>
<span><span class="co">#&gt; Go      64          0          5          5         62</span></span></code></pre></div>
<p>By comparing these go probabilities to the values provided in Table V
of <span class="citation">Neuenschwander et al. (2016)</span> one can
see that the results differ at most by 1 percentage point.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-chugh2009" class="csl-entry">
Chugh, Rashmi, J. Kyle Wathen, Robert G. Maki, Robert S. Benjamin,
Shreyaskumar R. Patel, Paul A. Myers, Dennis A. Priebat, et al. 2009.
<span>“Phase II Multicenter Trial of Imatinib in 10 Histologic Subtypes
of Sarcoma Using a Bayesian Hierarchical Statistical Model.”</span>
<em>Journal of Clinical Oncology</em> 27 (19): 3148–53. <a href="https://doi.org/10.1200/JCO.2008.20.5054" class="external-link">https://doi.org/10.1200/JCO.2008.20.5054</a>.
</div>
<div id="ref-exnex2016" class="csl-entry">
Neuenschwander, Beat, Simon Wandel, Satrajit Roychoudhury, and Stuart
Bailey. 2016. <span>“Robust Exchangeability Designs for Early Phase
Clinical Trials with Multiple Strata.”</span> <em>Pharmaceutical
Statistics</em> 15 (2): 123–34. <a href="https://doi.org/10.1002/pst.1730" class="external-link">https://doi.org/10.1002/pst.1730</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Stephan Wojciekowski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
